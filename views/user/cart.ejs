
<div class="site-content bg-punch-light overflow-hidden" id="content">
  <div class="container">
    <header class="entry-header space-top-2 space-bottom-1 mb-2">
      <h1 class="entry-title font-size-7">Your cart</h1>
    </header>
    <div class="row pb-8">
      <div id="primary" class="content-area">
        <main id="main" class="site-main">
          <div class="page type-page status-publish hentry">
            <div class="entry-content">
              <div class="woocommerce">
                <form
                  class="woocommerce-cart-form table-responsive"
                  action=""
                  method="post"
                >
                  <table
                    class="shop_table shop_table_responsive cart woocommerce-cart-form__contents"
                  >
                    <thead>
                      <tr>
                        <th class="product-name">Image</th>
                        <th class="product-name">Name</th>
                        <th class="product-price">Price</th>
                        <th class="product-quantity">Quantity</th>
                        <th class="product-subtotal">Total</th>
                        <th class="product-remove">Remove</th>
                      </tr>
                    </thead>
                    <tbody>
                      <%for(var i=0; i < product.items.length; i++){%>
                      <tr class="woocommerce-cart-form__cart-item cart_item">
                        <td>
                          <a href="#">
                            <img
                              src="/product-images/<%=product.items[i].item%>.jpg"
                              style="width: 30px"
                              class="attachment-shop_thumbnail size-shop_thumbnail wp-post-image"
                              alt=""
                            />
                          </a>
                        </td>
                        <td class="product-name" data-title="Product">
                          <div class="d-flex align-items-center">
                            <div class="m-w-200-lg-down">
                              <a href="#"> <%=product.items[i].name%> </a>
                              <a
                                href="#"
                                class="text-gray-700 font-size-2 d-block"
                                tabindex="0"
                              >
                                <%=product.items[i].author%>
                              </a>
                            </div>
                          </div>
                        </td>
                        <td class="product-price" data-title="Price">
                          <span class="woocommerce-Price-amount amount"
                            ><span class="woocommerce-Price-currencySymbol"
                              >₹</span
                            >
                            <%=product.items[i].price%>
                          </span>
                        </td>

                        <td class="product-quantity" data-title="Quantity">
                          <div class="quantity d-flex align-items-center">
                            <div class="border px-3 width-120">
                              <div class="js-quantity">
                                <div class="d-flex align-items-center">
                                  <label class="screen-reader-text sr-only"
                                    >Quantity</label
                                  >
                                  <a
                                    class="js-minus text-dark"
                                    onclick="changeQuantity('<%=product.items[i].item%>',-1)"
                                    href="javascript:;"
                                  >
                                    <svg
                                      xmlns="http://www.w3.org/2000/svg"
                                      xmlns:xlink="http://www.w3.org/1999/xlink"
                                      width="10px"
                                      height="1px"
                                    >
                                      <path
                                        fill-rule="evenodd"
                                        fill="rgb(22, 22, 25)"
                                        d="M-0.000,-0.000 L10.000,-0.000 L10.000,1.000 L-0.000,1.000 L-0.000,-0.000 Z"
                                      />
                                    </svg>
                                  </a>

                                  <input
                                    type="number"
                                    class="input-text qty text js-result form-control text-center border-0"
                                    step="1"
                                    min="1"
                                    max="100"
                                    name="quantity"
                                    value="<%=product.items[i].quantity%>"
                                    id="<%=product.items[i].item%>"
                                    title="Qty"
                                  />
                                  <a
                                    class="js-plus text-dark"
                                    onclick="changeQuantity('<%=product.items[i].item%>',+1)"
                                    href="javascript:;"
                                  >
                                    <svg
                                      xmlns="http://www.w3.org/2000/svg"
                                      xmlns:xlink="http://www.w3.org/1999/xlink"
                                      width="10px"
                                      height="10px"
                                    >
                                      <path
                                        fill-rule="evenodd"
                                        fill="rgb(22, 22, 25)"
                                        d="M10.000,5.000 L6.000,5.000 L6.000,10.000 L5.000,10.000 L5.000,5.000 L-0.000,5.000 L-0.000,4.000 L5.000,4.000 L5.000,-0.000 L6.000,-0.000 L6.000,4.000 L10.000,4.000 L10.000,5.000 Z"
                                      />
                                    </svg>
                                  </a>
                                </div>
                              </div>
                            </div>
                          </div>
                        </td>

                        <td class="product-subtotal" data-title="Total">
                          <span class="woocommerce-Price-amount amount"
                            ><span class="woocommerce-Price-currencySymbol"
                              >₹</span
                            >
                            <%=product.items[i].price%>
                          </span>
                        </td>

                        <td class="product-remove" style="text-align: center">
                          <a
                            href="/removeCartproduct?id=<%=product.items[i].item%>"
                            class="remove"
                            onclick="return confirm('Are you sure you want to delete this item?')"
                            aria-label="Remove this item"
                          >
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              xmlns:xlink="http://www.w3.org/1999/xlink"
                              width="15px"
                              height="15px"
                            >
                              <path
                                fill-rule="evenodd"
                                fill="rgb(22 , 22, 25)"
                                d="M15.011,13.899 L13.899,15.012 L7.500,8.613 L1.101,15.012 L-0.012,13.899 L6.387,7.500 L-0.012,1.101 L1.101,-0.012 L7.500,6.387 L13.899,-0.012 L15.011,1.101 L8.613,7.500 L15.011,13.899 Z"
                              />
                            </svg>
                          </a>
                        </td>
                      </tr>
                      <%}%>
                     
                    </tbody>
                  </table>
                </form>
              </div>
            </div>
          </div>
        </main>
      </div>

      <!-- sidee detailss  total -->  

      <div
        id="secondary"
        class="sidebar cart-collaterals order-1"
        role="complementary"
      >
        <div id="cartAccordion" class="border border-gray-900 bg-white mb-5">
          <div class="p-4d875 border">
            <div id="cartHeadingOne" class="cart-head">
              <a
                class="d-flex align-items-center justify-content-between text-dark"
                href="#"
                data-toggle="collapse"
                data-target="#cartCollapseOne"
                aria-expanded="true"
                aria-controls="cartCollapseOne"
              >
                <h3 class="cart-title mb-0 font-weight-medium font-size-3">
                  Cart Totals
                </h3>
                <svg
                  class="mins"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  width="15px"
                  height="2px"
                >
                  <path
                    fill-rule="evenodd"
                    fill="rgb(22, 22, 25)"
                    d="M0.000,-0.000 L15.000,-0.000 L15.000,2.000 L0.000,2.000 L0.000,-0.000 Z"
                  />
                </svg>
                <svg
                  class="plus"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  width="15px"
                  height="15px"
                >
                  <path
                    fill-rule="evenodd"
                    fill="rgb(22, 22, 25)"
                    d="M15.000,8.000 L9.000,8.000 L9.000,15.000 L7.000,15.000 L7.000,8.000 L0.000,8.000 L0.000,6.000 L7.000,6.000 L7.000,-0.000 L9.000,-0.000 L9.000,6.000 L15.000,6.000 L15.000,8.000 Z"
                  />
                </svg>
              </a>
            </div>
            <div
              id="cartCollapseOne"
              class="mt-4 cart-content collapse show"
              aria-labelledby="cartHeadingOne"
              data-parent="#cartAccordion"
            >
              <table class="shop_table shop_table_responsive">
                <tbody>
                  <tr class="cart-subtotal">
                    <th>Subtotal</th>
                    <td data-title="Subtotal">
                      <span class="woocommerce-Price-amount amount"
                        ><span class="woocommerce-Price-currencySymbol"
                          ><%=totalAmount.total%></span
                        ></span
                      >
                    </td>
                  </tr>
                  <!-- <tr class="order-shipping"> 
                                            <th>Shipping</th>
                                            <td data-title="Shipping">Free Shipping</td>
                                        </tr> -->
                </tbody>
              </table>
            </div>
          </div>
          <div class="p-4d875 border">
            <div id="cartHeadingTwo" class="cart-head">
              <a
                class="d-flex align-items-center justify-content-between text-dark"
                href="#"
                data-toggle="collapse"
                data-target="#cartCollapseTwo"
                aria-expanded="true"
                aria-controls="cartCollapseTwo"
              >
                <h3 class="cart-title mb-0 font-weight-medium font-size-3">
                  Shipping
                </h3>
                <svg
                  class="mins"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  width="15px"
                  height="2px"
                >
                  <path
                    fill-rule="evenodd"
                    fill="rgb(22, 22, 25)"
                    d="M0.000,-0.000 L15.000,-0.000 L15.000,2.000 L0.000,2.000 L0.000,-0.000 Z"
                  />
                </svg>
                <svg
                  class="plus"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  width="15px"
                  height="15px"
                >
                  <path
                    fill-rule="evenodd"
                    fill="rgb(22, 22, 25)"
                    d="M15.000,8.000 L9.000,8.000 L9.000,15.000 L7.000,15.000 L7.000,8.000 L0.000,8.000 L0.000,6.000 L7.000,6.000 L7.000,-0.000 L9.000,-0.000 L9.000,6.000 L15.000,6.000 L15.000,8.000 Z"
                  />
                </svg>
              </a>
            </div>
            <div
              id="cartCollapseTwo"
              class="mt-4 cart-content collapse show"
              aria-labelledby="cartHeadingTwo"
              data-parent="#cartAccordion"
            >
              <ul id="shipping_method">
                <li>
                  <input
                    type="radio"
                    name="shipping_method[0]"
                    data-index="0"
                    id="shipping_method_0_flat_rate1"
                    value="flat_rate:1"
                    class="shipping_method"
                  />
                  <label for="shipping_method_0_flat_rate1"
                    >Free shipping</label
                  >
                </li>
                <li>
                  <input
                    type="radio"
                    name="shipping_method[0]"
                    data-index="0"
                    id="shipping_method_0_flat_rate2"
                    value="flat_rate:2"
                    class="shipping_method"
                    checked="checked"
                  />
                  <label for="shipping_method_0_flat_rate2"
                    >Flat rate:
                    <span class="woocommerce-Price-amount amount"
                      ><span class="woocommerce-Price-currencySymbol">₹</span
                      >15</span
                    ></label
                  >
                </li>
              </ul>
            </div>
          </div>
        
          <div class="p-4d875 border">
            <table class="shop_table shop_table_responsive">
              <tbody>
                <tr class="order-total">
                  <th>Total</th>
                  <td data-title="Total">
                    <strong
                      ><span class="woocommerce-Price-amount amount"
                        ><span class="woocommerce-Price-currencySymbol">₹</span
                        ><span id="_total"><%=totalAmount.total%></span></span
                      ></strong
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="wc-proceed-to-checkout">
          <a
            href="checkout"
            class="checkout-button button alt wc-forward btn btn-dark btn-block rounded-0 py-4"
            >Proceed to checkout</a
          >
        </div>
      </div>
    </div>
  </div>
</div> 

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- using ajax -->
<script>
  function changeQuantity(productId, count) {
    const quantity = document.getElementById(productId).value;
    console.log(productId, count, quantity);
    $.ajax({
      url: "changeQuantity",
      data: {
        productId,
        count,
      },
      method: "post",
      success: (resolve) => {
        console.log(resolve);
        if (resolve.status == "blockButton") {
        } else {
          if (count == -1) {
            document.getElementById("_total").innerHTML = resolve.total;
            document.getElementById(productId).value = parseInt(quantity) - 1;
          } else {
            document.getElementById("_total").innerHTML = resolve.total;
            document.getElementById(productId).value = parseInt(quantity) + 1;
          }
        }
      },
    });
  }
</script>
